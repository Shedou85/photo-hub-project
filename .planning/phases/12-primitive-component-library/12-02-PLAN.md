---
phase: 12-primitive-component-library
plan: 02
type: execute
wave: 2
depends_on: ["12-01"]
files_modified:
  - frontend/src/components/primitives/PhotoCard.jsx
  - frontend/src/components/primitives/UploadZone.jsx
autonomous: true
must_haves:
  truths:
    - "PhotoCard renders a photo thumbnail with aspect-square, rounded corners, and lazy loading"
    - "PhotoCard shows a cover badge (gradient star) when isCover is true"
    - "PhotoCard shows a selection checkmark when isSelected is true"
    - "PhotoCard supports a hover actions overlay via compound component pattern (PhotoCard.Actions + PhotoCard.Action)"
    - "UploadZone renders a dashed-border dropzone with drag-drop support in default variant"
    - "UploadZone renders a compact button with plus icon in compact variant"
    - "UploadZone supports blue and green color themes"
    - "Both components have JSDoc with @param and @example tags"
  artifacts:
    - path: "frontend/src/components/primitives/PhotoCard.jsx"
      provides: "Photo grid item with hover actions and selection state"
      contains: "function PhotoCard"
    - path: "frontend/src/components/primitives/UploadZone.jsx"
      provides: "File upload zone with drag-drop and compact variants"
      contains: "function UploadZone"
  key_links:
    - from: "frontend/src/components/primitives/PhotoCard.jsx"
      to: "clsx"
      via: "import statement"
      pattern: "import clsx from 'clsx'"
    - from: "frontend/src/components/primitives/PhotoCard.jsx"
      to: "React.memo"
      via: "performance optimization"
      pattern: "memo\\(function PhotoCard"
    - from: "frontend/src/components/primitives/UploadZone.jsx"
      to: "react"
      via: "useRef hook"
      pattern: "import.*useRef.*from 'react'"
---

<objective>
Create the two complex primitive components: PhotoCard (compound component with hover actions overlay and selection/cover state) and UploadZone (drag-drop file upload with default and compact variants).

Purpose: Extract the photo grid item pattern (~50 lines per instance in CollectionDetailsPage) and upload zone pattern (~60 lines per instance) into reusable components. PhotoCard uses compound component pattern (PhotoCard.Actions, PhotoCard.Action) for flexible hover overlays. UploadZone provides both large dropzone and compact button variants from a single component.

Output: Two documented complex components completing the primitive component library (5 total components across plans 01 and 02).
</objective>

<execution_context>
@C:/Users/Marius/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Marius/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-primitive-component-library/12-01-SUMMARY.md — Button/Card/Badge implementation patterns, clsx installed

@frontend/tailwind.config.js — Design tokens (colors, typography, border-radius, shadows)
@frontend/src/pages/CollectionDetailsPage.jsx — Source patterns for PhotoCard (lines 838-890) and UploadZone (lines 729-791)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PhotoCard compound component with hover actions and selection state</name>
  <files>
    frontend/src/components/primitives/PhotoCard.jsx
  </files>
  <action>
Create `frontend/src/components/primitives/PhotoCard.jsx` with a compound component pattern:

**Main component: PhotoCard**

- Import `{ memo }` from 'react' and `clsx` from 'clsx'
- JSDoc comment block with `@param` for all props and two `@example` tags:
  - Example 1: Basic photo card with onClick
  - Example 2: Photo card with isCover, isSelected, and hover actions using PhotoCard.Actions/Action
- Wrap with `memo()` for performance optimization (Pitfall 2 from research -- prevents unnecessary re-renders in 100+ photo grids)
- Function declaration: `const PhotoCard = memo(function PhotoCard(...))`
- Props: `src` (string, required), `alt` (string, required), `onClick` (function, required), `isCover` (boolean, default false), `isSelected` (boolean, default false), `actions` (ReactNode, optional), `className` (optional)
- Outer div: `'relative group aspect-square overflow-hidden bg-gray-100'` plus `className`
  - Use `rounded-sm` for the photo card container (matches existing pattern from CollectionDetailsPage)
- Inner button for clickable area:
  - `className="w-full h-full block border-none p-0 bg-transparent cursor-zoom-in"`
  - Contains `<img>` with `src`, `alt`, `className="w-full h-full object-cover"`, `loading="lazy"`
  - `aria-label={alt}` on the button for accessibility
- Cover badge (render if `isCover` is true):
  - `className="absolute top-1 left-1 bg-[linear-gradient(135deg,#3b82f6,#6366f1)] text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full leading-tight pointer-events-none"`
  - Content: star character (Unicode star, not emoji)
- Selection checkmark (render if `isSelected` is true):
  - `className="absolute top-2 right-2 w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center shadow-md"`
  - Contains SVG checkmark: `<svg className="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={3}><path strokeLinecap="round" strokeLinejoin="round" d="M5 13l4 4L19 7" /></svg>`
- Actions overlay: render `{actions}` (passed as prop; parent uses PhotoCard.Actions)

**Sub-component: PhotoCard.Actions**

- JSDoc comment: "Container for hover action buttons displayed on PhotoCard hover (compound component pattern)."
- Assigned to `PhotoCard.Actions = function PhotoCardActions({ children })`
- `className="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity flex flex-col items-end justify-start gap-1 p-1 pointer-events-none"`
- Renders `{children}` (expects PhotoCard.Action elements)

**Sub-component: PhotoCard.Action**

- JSDoc comment: "Individual action button within PhotoCard.Actions overlay."
- Assigned to `PhotoCard.Action = function PhotoCardAction({ onClick, label, children })`
- onClick handler wraps with `e.stopPropagation()` to prevent triggering PhotoCard's onClick
- `className="w-7 h-7 rounded-full bg-white/90 hover:bg-red-100 text-gray-700 hover:text-red-600 flex items-center justify-center text-sm font-bold transition-colors pointer-events-auto"`
- Has `title={label}` and `aria-label={label}` for accessibility
- Renders `{children}` (icon content)

Export: `export default PhotoCard;`

**No PropTypes.** Use JSDoc only for documentation (per project convention).
  </action>
  <verify>
1. `cd frontend && npx eslint src/components/primitives/PhotoCard.jsx` — no lint errors
2. Verify file has JSDoc with @example tags on main component
3. Verify PhotoCard.Actions and PhotoCard.Action are defined as properties on PhotoCard
4. Verify memo() wraps the main component
  </verify>
  <done>
- PhotoCard.jsx exists with memo-wrapped main component
- PhotoCard.Actions sub-component renders hover overlay with opacity transition
- PhotoCard.Action sub-component renders accessible action buttons with stopPropagation
- Cover badge renders gradient star when isCover=true
- Selection checkmark renders blue circle with SVG check when isSelected=true
- Lazy loading on img element
- JSDoc with @param and @example tags
  </done>
</task>

<task type="auto">
  <name>Task 2: Create UploadZone component with default and compact variants</name>
  <files>
    frontend/src/components/primitives/UploadZone.jsx
  </files>
  <action>
Create `frontend/src/components/primitives/UploadZone.jsx` with two display variants:

- Import `{ useRef }` from 'react' and `clsx` from 'clsx'
- JSDoc comment block with `@param` for all props and three `@example` tags:
  - Example 1: Default large dropzone with drag-drop handlers
  - Example 2: Compact button variant for "Add More Photos"
  - Example 3: Green-themed dropzone for edited photo uploads

**Function declaration: `function UploadZone(...)`**

Props:
- `onFilesSelected` (function, required) — callback receiving FileList when files chosen
- `accept` (array of strings, default `['image/jpeg', 'image/png', 'image/webp']`) — accepted MIME types
- `multiple` (boolean, default true) — allow multi-file selection
- `dragOver` (boolean, default false) — external drag-over state from parent
- `onDragOver` (function, optional) — drag over callback
- `onDragLeave` (function, optional) — drag leave callback
- `onDrop` (function, optional) — drop callback
- `variant` (string, default 'default') — `'default'` or `'compact'`
- `label` (string, optional) — primary text label
- `hint` (string, optional) — secondary hint text
- `theme` (string, default 'blue') — `'blue'` or `'green'`

**Internal state:**
- `const fileInputRef = useRef(null);` — hidden file input reference

**Theme classes object:**
```
blue: {
  border: dragOver ? 'border-blue-500' : 'border-gray-300 hover:border-blue-400',
  bg: dragOver ? 'bg-blue-50' : 'bg-gray-50 hover:bg-blue-50/50',
  icon: dragOver ? 'text-blue-500' : 'text-gray-400',
}
green: {
  border: 'border-green-300 hover:border-green-400',
  bg: 'bg-green-50',
  icon: 'text-green-500',
}
```

**Handlers:**
- `handleClick` — triggers `fileInputRef.current?.click()`
- `handleKeyDown` — if `e.key === 'Enter'`, calls `handleClick()` (keyboard accessibility)
- `handleFileChange` — if `e.target.files.length > 0`, calls `onFilesSelected(e.target.files)` then resets input value to empty string (allows re-upload of same file)

**Compact variant rendering (if `variant === 'compact'`):**
- Renders a Fragment containing:
  - `<button>` with `className="inline-flex items-center gap-2 py-2.5 px-5 text-sm font-semibold text-blue-600 bg-blue-50 border border-blue-200 rounded-sm hover:bg-blue-100 transition-colors cursor-pointer font-sans"`
  - Contains plus icon SVG: `<svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 4v16m8-8H4" /></svg>`
  - Contains `{label}`
  - Hidden `<input type="file">` with ref, accept, multiple, className="hidden", onChange={handleFileChange}
- Return early (do not render default variant)

**Default variant rendering:**
- Renders a Fragment containing:
  - `<div>` with role="button", tabIndex={0}, aria-label={label}
  - onClick={handleClick}, onKeyDown={handleKeyDown}
  - onDrop={onDrop}, onDragOver={onDragOver}, onDragLeave={onDragLeave}
  - `className` via clsx: `'border-2 border-dashed rounded flex flex-col items-center justify-center gap-2 py-10 cursor-pointer transition-colors select-none'` plus theme border and bg classes
  - Contains upload icon SVG: `<svg className={clsx('w-9 h-9', themeClasses[theme].icon)} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={1.5}><path strokeLinecap="round" strokeLinejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" /></svg>`
  - Label: `<p className="m-0 text-sm font-medium text-gray-600">{label}</p>`
  - Hint (conditional): `{hint && <p className="m-0 text-xs text-gray-400">{hint}</p>}`
  - Hidden `<input type="file">` with ref, accept (joined with comma), multiple, className="hidden", onChange={handleFileChange}

Export: `export default UploadZone;`

**No PropTypes.** Use JSDoc only for documentation (per project convention).

**Important:** The UploadZone is a "dumb" UI component. It does NOT validate file sizes or types internally. It does NOT make API calls. The parent component is responsible for validation and upload logic. The `onFilesSelected` callback receives the raw FileList for the parent to process.
  </action>
  <verify>
1. `cd frontend && npx eslint src/components/primitives/UploadZone.jsx` — no lint errors
2. Verify file has JSDoc with @example tags
3. Verify both 'default' and 'compact' variant code paths exist
4. Verify hidden file input with ref pattern
5. `npm run build` — production build succeeds with all 5 components
  </verify>
  <done>
- UploadZone.jsx exists with default (dashed dropzone) and compact (button) variants
- Default variant has drag-drop event handler props (onDragOver, onDragLeave, onDrop)
- Default variant shows upload icon, label text, and optional hint text
- Compact variant shows plus icon and label as a styled button
- Blue and green color themes supported via theme prop
- Hidden file input with ref for programmatic click
- Input value reset after selection (allows re-upload of same file)
- Keyboard accessible (Enter key triggers file browser)
- JSDoc with @param and @example tags
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run lint` — zero warnings/errors across entire frontend
2. `npm run build` — production build succeeds
3. All 5 primitive component files exist in `frontend/src/components/primitives/`:
   - Button.jsx, Card.jsx, Badge.jsx (from Plan 01)
   - PhotoCard.jsx, UploadZone.jsx (from this plan)
4. Each component file contains JSDoc with at least one `@example` tag
5. PhotoCard uses `memo()` wrapper
6. PhotoCard has `.Actions` and `.Action` compound sub-components
7. UploadZone has both 'default' and 'compact' variant rendering paths
</verification>

<success_criteria>
- PhotoCard component exists with compound component pattern (PhotoCard.Actions, PhotoCard.Action)
- PhotoCard wraps in memo() for grid performance
- UploadZone component exists with default (dropzone) and compact (button) variants
- Both components documented with JSDoc including @param and @example tags
- ESLint passes with zero warnings across all primitives
- Production build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/12-primitive-component-library/12-02-SUMMARY.md`
</output>
